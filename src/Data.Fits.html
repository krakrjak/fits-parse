<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Data.Fits
Description : Types for FITS Data Units
Copyright   : (c) Zac Slade, 2018
License     : BSD2
Maintainer  : krakrjak@gmail.com
Stability   : experimental

Definitions for the data types needed to parse an HDU in a FITS block.
-}</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures, DataKinds, ExistentialQuantification
  , ScopedTypeVariables, GADTs
  , OverloadedStrings, TypeOperators, TypeFamilies #-}</span><span>
</span><a name="line-15"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Fits</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * Main data types</span><span>
</span><a name="line-17"></a><span>      </span><a href="Data.Fits.html#HeaderDataUnit"><span class="hs-identifier hs-type">HeaderDataUnit</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#HeaderData"><span class="hs-identifier hs-type">HeaderData</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>      </span><span class="hs-comment">-- ** Helper data types</span><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#SimpleFormat"><span class="hs-identifier hs-type">SimpleFormat</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#StringType"><span class="hs-identifier hs-type">StringType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#NumberType"><span class="hs-identifier hs-type">NumberType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#NumberModifier"><span class="hs-identifier hs-type">NumberModifier</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#NumberValue"><span class="hs-identifier hs-type">NumberValue</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#Axis"><span class="hs-identifier hs-type">Axis</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>      </span><span class="hs-comment">-- * Utility</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#bitPixToWordSize"><span class="hs-identifier hs-var">bitPixToWordSize</span></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#hduRecordLength"><span class="hs-identifier hs-var">hduRecordLength</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#hduMaxRecords"><span class="hs-identifier hs-var">hduMaxRecords</span></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#hduBlockSize"><span class="hs-identifier hs-var">hduBlockSize</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Fits.html#parsePix"><span class="hs-identifier hs-var">parsePix</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">---- text</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-40"></a><span class="hs-comment">---- bytestring</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BL</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">---- base</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Numeric.Natural</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Natural</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">---- ghc</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.TypeNats</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">KnownNat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">---- text</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">---- bytestring</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">---- default</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Default</span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Default</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">---- binaryi</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Binary</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Binary.Get</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | A single record in the HDU is an eighty byte word.</span><span>
</span><a name="line-64"></a><span class="hs-comment">{-@ type HDURecordLength = {v:Int | v = 80} @-}</span><span>
</span><a name="line-65"></a><span class="hs-comment">{-@ hduRecordLength :: HDURecordLength @-}</span><span>
</span><a name="line-66"></a><span class="hs-identifier">hduRecordLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-67"></a><a name="hduRecordLength"><a href="Data.Fits.html#hduRecordLength"><span class="hs-identifier">hduRecordLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">80</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">{-| The maximum amount of eighty byte records is thirty-six per the
    standard.
-}</span><span>
</span><a name="line-72"></a><span class="hs-comment">{-@ type HDUMaxRecords = {v:Int | v = 36} @-}</span><span>
</span><a name="line-73"></a><span class="hs-comment">{-@ hduMaxRecords :: HDUMaxRecords @-}</span><span>
</span><a name="line-74"></a><span class="hs-identifier">hduMaxRecords</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-75"></a><a name="hduMaxRecords"><a href="Data.Fits.html#hduMaxRecords"><span class="hs-identifier">hduMaxRecords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">36</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">{-| The size of an HDU block is fixed at thirty-six eighty byte words. In
    other words 2,880 bytes. These blocks are padded with zeros to this
    boundary.
-}</span><span>
</span><a name="line-81"></a><span class="hs-comment">{-@ type HDUBlockSize = {v:Int | v = 2880} @-}</span><span>
</span><a name="line-82"></a><span class="hs-comment">{-@ hduBlockSize :: HDUBlockSize @-}</span><span>
</span><a name="line-83"></a><span class="hs-identifier">hduBlockSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-84"></a><a name="hduBlockSize"><a href="Data.Fits.html#hduBlockSize"><span class="hs-identifier">hduBlockSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#hduRecordLength"><span class="hs-identifier hs-var">hduRecordLength</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Data.Fits.html#hduMaxRecords"><span class="hs-identifier hs-var">hduMaxRecords</span></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">{-| There are many types of strings defined in the FITS documentation.
    Refered to as &quot;character string(s)&quot; in the documentation, they can be
    null, empty, undefined, or contain characters (printable ASCII only).
-}</span><span>
</span><a name="line-90"></a><span class="hs-keyword">data</span><span> </span><a name="StringType"><a href="Data.Fits.html#StringType"><span class="hs-identifier">StringType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NullString"><a href="Data.Fits.html#NullString"><span class="hs-identifier">NullString</span></a></a><span>      </span><span class="hs-comment">-- ^ The NULL character string (e.g. AUTHOR=)</span><span>
</span><a name="line-91"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="EmptyString"><a href="Data.Fits.html#EmptyString"><span class="hs-identifier">EmptyString</span></a></a><span>     </span><span class="hs-comment">-- ^ An empty string (e.g. AUTHOR=&quot;&quot;)</span><span>
</span><a name="line-92"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="DataString"><a href="Data.Fits.html#DataString"><span class="hs-identifier">DataString</span></a></a><span>      </span><span class="hs-comment">-- ^ Plain ASCII data</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Data.Fits.html#StringType"><span class="hs-identifier hs-type">StringType</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-95"></a><span>    </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a href="Data.Fits.html#NullString"><span class="hs-identifier hs-var">NullString</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Null String&quot;</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Data.Fits.html#EmptyString"><span class="hs-identifier hs-var">EmptyString</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Empty quoted String&quot;</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Data.Fits.html#DataString"><span class="hs-identifier hs-var">DataString</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;String&quot;</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | A 'StringValue' is a type paired with a possible value.</span><span>
</span><a name="line-100"></a><span class="hs-keyword">data</span><span> </span><a name="StringValue"><a href="Data.Fits.html#StringValue"><span class="hs-identifier">StringValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="StringValue"><a href="Data.Fits.html#StringValue"><span class="hs-identifier">StringValue</span></a></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="stringType"><a href="Data.Fits.html#stringType"><span class="hs-identifier">stringType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringType"><span class="hs-identifier hs-type">StringType</span></a><span>  </span><span class="hs-comment">-- ^ Which 'StringType' is this value?</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="stringValue"><a href="Data.Fits.html#stringValue"><span class="hs-identifier">stringValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-comment">-- ^ The payload of a character string</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">{-| The default instance of 'StringValue' is an undefined string with no
    text.
-}</span><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>    </span><a name="local-8214565720323792454"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-var">StringValue</span></a><span> </span><a href="Data.Fits.html#NullString"><span class="hs-identifier hs-var">NullString</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-112"></a><span>        </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-var">StringValue</span></a><span> </span><a href="Data.Fits.html#NullString"><span class="hs-identifier hs-var">NullString</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Data.Fits.html#NullString"><span class="hs-identifier hs-var">NullString</span></a><span>
</span><a name="line-113"></a><span>        </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-var">StringValue</span></a><span> </span><a href="Data.Fits.html#EmptyString"><span class="hs-identifier hs-var">EmptyString</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Data.Fits.html#EmptyString"><span class="hs-identifier hs-var">EmptyString</span></a><span>
</span><a name="line-114"></a><span>        </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-var">StringValue</span></a><span> </span><a href="Data.Fits.html#DataString"><span class="hs-identifier hs-var">DataString</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;No good &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Data.Fits.html#DataString"><span class="hs-identifier hs-var">DataString</span></a><span>
</span><a name="line-115"></a><span>        </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-var">StringValue</span></a><span> </span><a href="Data.Fits.html#DataString"><span class="hs-identifier hs-var">DataString</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679027829"><a href="#local-6989586621679027829"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Data.Fits.html#DataString"><span class="hs-identifier hs-var">DataString</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679027829"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">{-| The FITS standard allows for the encoding of unsigned integers, signed
    integers, real numbers, and complex numbers. They are always ASCII
    encoded. See 5.2 of the standard for more details.
-}</span><span>
</span><a name="line-121"></a><span class="hs-keyword">data</span><span> </span><a name="NumberType"><a href="Data.Fits.html#NumberType"><span class="hs-identifier">NumberType</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-122"></a><span>      </span><a name="IntegerType"><a href="Data.Fits.html#IntegerType"><span class="hs-identifier">IntegerType</span></a></a><span> </span><span class="hs-comment">-- ^ HDU ASCII encoded integer number</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="RealType"><a href="Data.Fits.html#RealType"><span class="hs-identifier">RealType</span></a></a><span>    </span><span class="hs-comment">-- ^ HDU ASCII encoded real number</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ComplexType"><a href="Data.Fits.html#ComplexType"><span class="hs-identifier">ComplexType</span></a></a><span> </span><span class="hs-comment">-- ^ HDU ASCII encoded complex number</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Utility data type to help with the ASCII representation of numbers</span><span>
</span><a name="line-127"></a><span class="hs-keyword">data</span><span> </span><a name="NumberModifier"><a href="Data.Fits.html#NumberModifier"><span class="hs-identifier">NumberModifier</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-128"></a><span>      </span><a name="Positive"><a href="Data.Fits.html#Positive"><span class="hs-identifier">Positive</span></a></a><span> </span><span class="hs-comment">-- ^ HDU positive number value</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Negative"><a href="Data.Fits.html#Negative"><span class="hs-identifier">Negative</span></a></a><span> </span><span class="hs-comment">-- ^ HDU negative number value</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="Zero"><a href="Data.Fits.html#Zero"><span class="hs-identifier">Zero</span></a></a><span>     </span><span class="hs-comment">-- ^ HDU numeric value is zero, could be positive or negative</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">{-| 'NumberValue' contains an encoded numeric record from a data field.
  This data type still needs to be converted into more useful Haskell data
  types.
-}</span><span>
</span><a name="line-136"></a><span class="hs-keyword">data</span><span> </span><a name="NumberValue"><a href="Data.Fits.html#NumberValue"><span class="hs-identifier">NumberValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NumberValue"><a href="Data.Fits.html#NumberValue"><span class="hs-identifier">NumberValue</span></a></a><span>
</span><a name="line-137"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="numberType"><a href="Data.Fits.html#numberType"><span class="hs-identifier">numberType</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#NumberType"><span class="hs-identifier hs-type">NumberType</span></a><span>
</span><a name="line-138"></a><span>      </span><span class="hs-comment">-- ^ Key to decoding the structure</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="realModifier"><a href="Data.Fits.html#realModifier"><span class="hs-identifier">realModifier</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#NumberModifier"><span class="hs-identifier hs-type">NumberModifier</span></a><span>
</span><a name="line-140"></a><span>      </span><span class="hs-comment">-- ^ Encoding the sign of the real part</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="realPart"><a href="Data.Fits.html#realPart"><span class="hs-identifier">realPart</span></a></a><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-142"></a><span>      </span><span class="hs-comment">-- ^ All 'NumberType' have a real part (sign stripped)</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="imaginaryModifier"><a href="Data.Fits.html#imaginaryModifier"><span class="hs-identifier">imaginaryModifier</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Fits.html#NumberModifier"><span class="hs-identifier hs-type">NumberModifier</span></a><span>
</span><a name="line-144"></a><span>      </span><span class="hs-comment">-- ^ Encoding the sign of the imaginary part</span><span>
</span><a name="line-145"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="imaginaryPart"><a href="Data.Fits.html#imaginaryPart"><span class="hs-identifier">imaginaryPart</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-146"></a><span>      </span><span class="hs-comment">-- ^ Only 'ComplexType' have an imaginary part (sign stripped)</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="exponentModifier"><a href="Data.Fits.html#exponentModifier"><span class="hs-identifier">exponentModifier</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Fits.html#NumberModifier"><span class="hs-identifier hs-type">NumberModifier</span></a><span>
</span><a name="line-148"></a><span>      </span><span class="hs-comment">-- ^ 'Positive', 'Negative', or 'Zero'</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="exponent"><a href="Data.Fits.html#exponent"><span class="hs-identifier">exponent</span></a></a><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-150"></a><span>      </span><span class="hs-comment">-- ^ All 'NumberType' may have an exponent</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">{-| The default instance for 'NumberValue' is a 32-bit integer of zero with
    no imaginary or exponent parts.
-}</span><span>
</span><a name="line-156"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><a href="Data.Fits.html#NumberValue"><span class="hs-identifier hs-type">NumberValue</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-157"></a><span>    </span><a name="local-8214565720323792454"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#NumberValue"><span class="hs-identifier hs-var">NumberValue</span></a><span> </span><a href="Data.Fits.html#IntegerType"><span class="hs-identifier hs-var">IntegerType</span></a><span> </span><a href="Data.Fits.html#Zero"><span class="hs-identifier hs-var">Zero</span></a><span> </span><span class="hs-string">&quot;0&quot;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">{-| The standard defines two possible values for the SIMPLE keyword, T and
    F. The T refers to a 'Conformant' format while F refers to
    a 'NonConformant' format. At this time only the 'Conformant', T, format
    is supported.
-}</span><span>
</span><a name="line-164"></a><span class="hs-keyword">data</span><span> </span><a name="SimpleFormat"><a href="Data.Fits.html#SimpleFormat"><span class="hs-identifier">SimpleFormat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Conformant"><a href="Data.Fits.html#Conformant"><span class="hs-identifier">Conformant</span></a></a><span>
</span><a name="line-165"></a><span>                    </span><span class="hs-comment">-- ^ Value of SIMPLE=T in the header. /supported/</span><span>
</span><a name="line-166"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="NonConformant"><a href="Data.Fits.html#NonConformant"><span class="hs-identifier">NonConformant</span></a></a><span>
</span><a name="line-167"></a><span>                    </span><span class="hs-comment">-- ^ Value of SIMPLE=F in the header. /unsupported/</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-comment">-- | 'Axis' represents a single NAXIS record.</span><span>
</span><a name="line-170"></a><span class="hs-keyword">data</span><span> </span><a name="Axis"><a href="Data.Fits.html#Axis"><span class="hs-identifier">Axis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Axis"><a href="Data.Fits.html#Axis"><span class="hs-identifier">Axis</span></a></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="axisNumber"><a href="Data.Fits.html#axisNumber"><span class="hs-identifier">axisNumber</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ The axis number under consideration</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="axisElementCount"><a href="Data.Fits.html#axisElementCount"><span class="hs-identifier">axisElementCount</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ The number of elements in this axis</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-comment">-- | The default instance for 'Axis' is NAXIS=0 with zero elements.</span><span>
</span><a name="line-176"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><a href="Data.Fits.html#Axis"><span class="hs-identifier hs-type">Axis</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>    </span><a name="local-8214565720323792454"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#Axis"><span class="hs-identifier hs-var">Axis</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">{-| The 'BitPixFormat' is the nitty gritty of how the 'Axis' data is layed
    out in the file. The standard recognizes six formats: unsigned 8 bit
    integer, two's complement binary integers at 16, 32, and 64 bits along
    with 32 and 64 bit IEEE floating point formats.
-}</span><span>
</span><a name="line-184"></a><span class="hs-keyword">data</span><span> </span><a name="BitPixFormat"><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier">BitPixFormat</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-185"></a><span>      </span><a name="EightBitInt"><a href="Data.Fits.html#EightBitInt"><span class="hs-identifier">EightBitInt</span></a></a><span>       </span><span class="hs-comment">-- ^ BITPIX = 8; unsigned binary integer of 8 bits</span><span>
</span><a name="line-186"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="SixteenBitInt"><a href="Data.Fits.html#SixteenBitInt"><span class="hs-identifier">SixteenBitInt</span></a></a><span>     </span><span class="hs-comment">-- ^ BITPIX = 16; two's complement binary integer of 16 bits</span><span>
</span><a name="line-187"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ThirtyTwoBitInt"><a href="Data.Fits.html#ThirtyTwoBitInt"><span class="hs-identifier">ThirtyTwoBitInt</span></a></a><span>   </span><span class="hs-comment">-- ^ BITPIX = 32; two's complement binary integer of 32 bits</span><span>
</span><a name="line-188"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="SixtyFourBitInt"><a href="Data.Fits.html#SixtyFourBitInt"><span class="hs-identifier">SixtyFourBitInt</span></a></a><span>   </span><span class="hs-comment">-- ^ BITPIX = 64; two's complement binary integer of 64 bits</span><span>
</span><a name="line-189"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ThirtyTwoBitFloat"><a href="Data.Fits.html#ThirtyTwoBitFloat"><span class="hs-identifier">ThirtyTwoBitFloat</span></a></a><span> </span><span class="hs-comment">-- ^ BITPIX = -32; IEEE single precision floating point of 32 bits</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="SixtyFourBitFloat"><a href="Data.Fits.html#SixtyFourBitFloat"><span class="hs-identifier">SixtyFourBitFloat</span></a></a><span> </span><span class="hs-comment">-- ^ BITPIX = -64; IEEE double precision floating point of 64 bits</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-193"></a><span>        </span><a name="local-8214565720323790323"><span class="hs-identifier">show</span></a><span> </span><a href="Data.Fits.html#EightBitInt"><span class="hs-identifier hs-var">EightBitInt</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;8 bit unsigned integer&quot;</span><span>
</span><a name="line-194"></a><span>        </span><span class="hs-identifier">show</span><span> </span><a href="Data.Fits.html#SixteenBitInt"><span class="hs-identifier hs-var">SixteenBitInt</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;16 bit signed integer&quot;</span><span>
</span><a name="line-195"></a><span>        </span><span class="hs-identifier">show</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitInt"><span class="hs-identifier hs-var">ThirtyTwoBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;32 bit signed integer&quot;</span><span>
</span><a name="line-196"></a><span>        </span><span class="hs-identifier">show</span><span> </span><a href="Data.Fits.html#SixtyFourBitInt"><span class="hs-identifier hs-var">SixtyFourBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;64 bit signed interger&quot;</span><span>
</span><a name="line-197"></a><span>        </span><span class="hs-identifier">show</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitFloat"><span class="hs-identifier hs-var">ThirtyTwoBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;32 bit IEEE single precision float&quot;</span><span>
</span><a name="line-198"></a><span>        </span><span class="hs-identifier">show</span><span> </span><a href="Data.Fits.html#SixtyFourBitFloat"><span class="hs-identifier hs-var">SixtyFourBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;64 bit IEEE double precision float&quot;</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">{-| This utility function can be used to get the word count for data in an
    HDU.
-}</span><span>
</span><a name="line-203"></a><span class="hs-identifier">bitPixToWordSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span>
</span><a name="line-204"></a><a name="bitPixToWordSize"><a href="Data.Fits.html#bitPixToWordSize"><span class="hs-identifier">bitPixToWordSize</span></a></a><span> </span><a href="Data.Fits.html#EightBitInt"><span class="hs-identifier hs-var">EightBitInt</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-205"></a><span class="hs-identifier">bitPixToWordSize</span><span> </span><a href="Data.Fits.html#SixteenBitInt"><span class="hs-identifier hs-var">SixteenBitInt</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-206"></a><span class="hs-identifier">bitPixToWordSize</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitInt"><span class="hs-identifier hs-var">ThirtyTwoBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">32</span><span>
</span><a name="line-207"></a><span class="hs-identifier">bitPixToWordSize</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitFloat"><span class="hs-identifier hs-var">ThirtyTwoBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">32</span><span>
</span><a name="line-208"></a><span class="hs-identifier">bitPixToWordSize</span><span> </span><a href="Data.Fits.html#SixtyFourBitInt"><span class="hs-identifier hs-var">SixtyFourBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-209"></a><span class="hs-identifier">bitPixToWordSize</span><span> </span><a href="Data.Fits.html#SixtyFourBitFloat"><span class="hs-identifier hs-var">SixtyFourBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">64</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">{-| This utility function can be used to get the size in bytes of the
-   format.
-}</span><span>
</span><a name="line-214"></a><span class="hs-identifier">bitPixToByteSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Natural</span><span>
</span><a name="line-215"></a><a name="bitPixToByteSize"><a href="Data.Fits.html#bitPixToByteSize"><span class="hs-identifier">bitPixToByteSize</span></a></a><span> </span><a href="Data.Fits.html#EightBitInt"><span class="hs-identifier hs-var">EightBitInt</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-216"></a><span class="hs-identifier">bitPixToByteSize</span><span> </span><a href="Data.Fits.html#SixteenBitInt"><span class="hs-identifier hs-var">SixteenBitInt</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-217"></a><span class="hs-identifier">bitPixToByteSize</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitInt"><span class="hs-identifier hs-var">ThirtyTwoBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-218"></a><span class="hs-identifier">bitPixToByteSize</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitFloat"><span class="hs-identifier hs-var">ThirtyTwoBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-219"></a><span class="hs-identifier">bitPixToByteSize</span><span> </span><a href="Data.Fits.html#SixtyFourBitInt"><span class="hs-identifier hs-var">SixtyFourBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-220"></a><span class="hs-identifier">bitPixToByteSize</span><span> </span><a href="Data.Fits.html#SixtyFourBitFloat"><span class="hs-identifier hs-var">SixtyFourBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">{- | `Pix` contains the data representation for that single data point.
     A `Pix` datatype can be just about any `Num` type
-}</span><span>
</span><a name="line-226"></a><span class="hs-keyword">data</span><span> </span><a name="Pix"><a href="Data.Fits.html#Pix"><span class="hs-identifier">Pix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679025767"><a href="#local-6989586621679025767"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679025767"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Pix"><a href="Data.Fits.html#Pix"><span class="hs-identifier">Pix</span></a></a><span> </span><a href="#local-6989586621679025767"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^A Unit of FITS data</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-identifier">getPix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Get</span><span> </span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-type">Pix</span></a><span>
</span><a name="line-229"></a><a name="getPix"><a href="Data.Fits.html#getPix"><span class="hs-identifier">getPix</span></a></a><span> </span><a href="Data.Fits.html#EightBitInt"><span class="hs-identifier hs-var">EightBitInt</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-var">Pix</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">getInt8</span><span>
</span><a name="line-230"></a><span class="hs-identifier">getPix</span><span> </span><a href="Data.Fits.html#SixteenBitInt"><span class="hs-identifier hs-var">SixteenBitInt</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-var">Pix</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">getInt16be</span><span>
</span><a name="line-231"></a><span class="hs-identifier">getPix</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitInt"><span class="hs-identifier hs-var">ThirtyTwoBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-var">Pix</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">getInt32be</span><span>
</span><a name="line-232"></a><span class="hs-identifier">getPix</span><span> </span><a href="Data.Fits.html#SixtyFourBitInt"><span class="hs-identifier hs-var">SixtyFourBitInt</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-var">Pix</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">getInt64be</span><span>
</span><a name="line-233"></a><span class="hs-identifier">getPix</span><span> </span><a href="Data.Fits.html#ThirtyTwoBitFloat"><span class="hs-identifier hs-var">ThirtyTwoBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-var">Pix</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">getFloatbe</span><span>
</span><a name="line-234"></a><span class="hs-identifier">getPix</span><span> </span><a href="Data.Fits.html#SixtyFourBitFloat"><span class="hs-identifier hs-var">SixtyFourBitFloat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-var">Pix</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">getDoublebe</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-identifier">getPixs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Get</span><span> </span><span class="hs-special">[</span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-type">Pix</span></a><span class="hs-special">]</span><span>
</span><a name="line-237"></a><a name="getPixs"><a href="Data.Fits.html#getPixs"><span class="hs-identifier">getPixs</span></a></a><span> </span><a name="local-6989586621679028883"><a href="#local-6989586621679028883"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679028884"><a href="#local-6989586621679028884"><span class="hs-identifier">bpf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-238"></a><span>    </span><a name="local-6989586621679028885"><a href="#local-6989586621679028885"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">isEmpty</span><span>
</span><a name="line-239"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679028885"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-240"></a><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-241"></a><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-242"></a><span>        </span><a name="local-6989586621679028886"><a href="#local-6989586621679028886"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Fits.html#getPix"><span class="hs-identifier hs-var">getPix</span></a><span> </span><a href="#local-6989586621679028884"><span class="hs-identifier hs-var">bpf</span></a><span>
</span><a name="line-243"></a><span>        </span><a name="local-6989586621679028887"><a href="#local-6989586621679028887"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Fits.html#getPixs"><span class="hs-identifier hs-var">getPixs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028883"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028884"><span class="hs-identifier hs-var">bpf</span></a><span>
</span><a name="line-244"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679028886"><span class="hs-identifier hs-var">p</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679028887"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-comment">{- `parsePix` takes an element count, a format and a bytestring and
 produces a column-row major list of data elements from the bytestring.
-}</span><span>
</span><a name="line-249"></a><span class="hs-identifier">parsePix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">BL.ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="Data.Fits.html#Pix"><span class="hs-identifier hs-type">Pix</span></a><span class="hs-special">]</span><span>
</span><a name="line-250"></a><a name="parsePix"><a href="Data.Fits.html#parsePix"><span class="hs-identifier">parsePix</span></a></a><span> </span><a name="local-6989586621679028888"><a href="#local-6989586621679028888"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679028889"><a href="#local-6989586621679028889"><span class="hs-identifier">bpf</span></a></a><span> </span><a name="local-6989586621679028890"><a href="#local-6989586621679028890"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">runGet</span><span> </span><span class="hs-special">(</span><a href="Data.Fits.html#getPixs"><span class="hs-identifier hs-var">getPixs</span></a><span> </span><a href="#local-6989586621679028888"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679028889"><span class="hs-identifier hs-var">bpf</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679028890"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-comment">{- `pixDimsByCol` takes a list of Axis and gives a column-row major list of
    axes dimensions.
-}</span><span>
</span><a name="line-255"></a><span class="hs-identifier">pixDimsByCol</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.Fits.html#Axis"><span class="hs-identifier hs-type">Axis</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-256"></a><a name="pixDimsByCol"><a href="Data.Fits.html#pixDimsByCol"><span class="hs-identifier">pixDimsByCol</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">axisElementCount</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">{- `pixDimsByRow` takes a list of Axis and gives a row-column major list of
    axes dimensions.
-}</span><span>
</span><a name="line-261"></a><span class="hs-identifier">pixDimsByRow</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.Fits.html#Axis"><span class="hs-identifier hs-type">Axis</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-262"></a><a name="pixDimsByRow"><a href="Data.Fits.html#pixDimsByRow"><span class="hs-identifier">pixDimsByRow</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Fits.html#pixDimsByCol"><span class="hs-identifier hs-var">pixDimsByCol</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">{-| The header part of the HDU is vital carrying not only authorship
    metadata, but also specifying how to make sense of the binary payload
    that starts 2,880 bytes after the start of the 'HeaderData'.
-}</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-keyword">data</span><span> </span><a name="HeaderData"><a href="Data.Fits.html#HeaderData"><span class="hs-identifier">HeaderData</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="HeaderData"><a href="Data.Fits.html#HeaderData"><span class="hs-identifier">HeaderData</span></a></a><span>
</span><a name="line-270"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="simpleFormat"><a href="Data.Fits.html#simpleFormat"><span class="hs-identifier">simpleFormat</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#SimpleFormat"><span class="hs-identifier hs-type">SimpleFormat</span></a><span>
</span><a name="line-271"></a><span>      </span><span class="hs-comment">-- ^ SIMPLE</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="bitPixFormat"><a href="Data.Fits.html#bitPixFormat"><span class="hs-identifier">bitPixFormat</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#BitPixFormat"><span class="hs-identifier hs-type">BitPixFormat</span></a><span>
</span><a name="line-273"></a><span>      </span><span class="hs-comment">-- ^ BITPIX</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="axes"><a href="Data.Fits.html#axes"><span class="hs-identifier">axes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.Fits.html#Axis"><span class="hs-identifier hs-type">Axis</span></a><span class="hs-special">]</span><span>
</span><a name="line-275"></a><span>      </span><span class="hs-comment">-- ^ Axes metadata</span><span>
</span><a name="line-276"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="objectIdentifier"><a href="Data.Fits.html#objectIdentifier"><span class="hs-identifier">objectIdentifier</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-277"></a><span>      </span><span class="hs-comment">-- ^ OBJECT</span><span>
</span><a name="line-278"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="observationDate"><a href="Data.Fits.html#observationDate"><span class="hs-identifier">observationDate</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-279"></a><span>      </span><span class="hs-comment">-- ^ DATE</span><span>
</span><a name="line-280"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="originIdentifier"><a href="Data.Fits.html#originIdentifier"><span class="hs-identifier">originIdentifier</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-281"></a><span>      </span><span class="hs-comment">-- ^ OBJECT</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="telescopeIdentifier"><a href="Data.Fits.html#telescopeIdentifier"><span class="hs-identifier">telescopeIdentifier</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-283"></a><span>      </span><span class="hs-comment">-- ^ TELESCOP</span><span>
</span><a name="line-284"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="instrumentIdentifier"><a href="Data.Fits.html#instrumentIdentifier"><span class="hs-identifier">instrumentIdentifier</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-285"></a><span>      </span><span class="hs-comment">-- ^ INSTRUME</span><span>
</span><a name="line-286"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="observerIdentifier"><a href="Data.Fits.html#observerIdentifier"><span class="hs-identifier">observerIdentifier</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-287"></a><span>      </span><span class="hs-comment">-- ^ OBSERVER</span><span>
</span><a name="line-288"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="authorIdentifier"><a href="Data.Fits.html#authorIdentifier"><span class="hs-identifier">authorIdentifier</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-289"></a><span>      </span><span class="hs-comment">-- ^ CREATOR</span><span>
</span><a name="line-290"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="referenceString"><a href="Data.Fits.html#referenceString"><span class="hs-identifier">referenceString</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span>
</span><a name="line-291"></a><span>      </span><span class="hs-comment">-- ^ REFERENC</span><span>
</span><a name="line-292"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><a href="Data.Fits.html#HeaderData"><span class="hs-identifier hs-type">HeaderData</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-295"></a><span>    </span><a name="local-8214565720323792454"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Fits.html#HeaderData"><span class="hs-identifier hs-var">HeaderData</span></a><span> </span><a href="Data.Fits.html#NonConformant"><span class="hs-identifier hs-var">NonConformant</span></a><span> </span><a href="Data.Fits.html#EightBitInt"><span class="hs-identifier hs-var">EightBitInt</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-296"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#StringValue"><span class="hs-identifier hs-type">StringValue</span></a><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-comment">{-| The 'HeaderDataUnit' is the full HDU. Both the header information is
    encoded alongside the 'Axis' payload.
-}</span><span>
</span><a name="line-303"></a><span class="hs-keyword">data</span><span> </span><a name="HeaderDataUnit"><a href="Data.Fits.html#HeaderDataUnit"><span class="hs-identifier">HeaderDataUnit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="HeaderDataUnit"><a href="Data.Fits.html#HeaderDataUnit"><span class="hs-identifier">HeaderDataUnit</span></a></a><span>
</span><a name="line-304"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="headerData"><a href="Data.Fits.html#headerData"><span class="hs-identifier">headerData</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Fits.html#HeaderData"><span class="hs-identifier hs-type">HeaderData</span></a><span>
</span><a name="line-305"></a><span>      </span><span class="hs-comment">-- ^ Just the header part of the HDU</span><span>
</span><a name="line-306"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="payloadData"><a href="Data.Fits.html#payloadData"><span class="hs-identifier">payloadData</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-307"></a><span>      </span><span class="hs-comment">-- ^ The actual data payload</span><span>
</span><a name="line-308"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-309"></a></pre></body></html>